import{e as L,p as H,q as j,h as O,s as R,x,y as I,z as P,A as G,B as q,C as B}from"./index-CozHna6C.js";import{a as K,e as $}from"./index-HRYNUPNB.js";function Q(e){return I()?(P(e),!0):!1}function N(e){return typeof e=="function"?e():L(e)}const U=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const X=Object.prototype.toString,Y=e=>X.call(e)==="[object Object]",Z=()=>{};function ee(e,r){function t(...n){return new Promise((a,i)=>{Promise.resolve(e(()=>r.apply(this,n),{fn:r,thisArg:this,args:n})).then(a).catch(i)})}return t}const D=e=>e();function te(e=D){const r=O(!0);function t(){r.value=!1}function n(){r.value=!0}const a=(...i)=>{r.value&&e(...i)};return{isActive:R(r),pause:t,resume:n,eventFilter:a}}function re(e){return G()}function ne(e,r,t={}){const{eventFilter:n=D,...a}=t;return x(e,ee(n,r),a)}function oe(e,r,t={}){const{eventFilter:n,...a}=t,{eventFilter:i,pause:u,resume:m,isActive:S}=te(n);return{stop:ne(e,r,{...a,eventFilter:i}),pause:u,resume:m,isActive:S}}function ae(e,r=!0,t){re()?H(e,t):r?e():j(e)}const C=U?window:void 0;function se(e){var r;const t=N(e);return(r=t==null?void 0:t.$el)!=null?r:t}function T(...e){let r,t,n,a;if(typeof e[0]=="string"||Array.isArray(e[0])?([t,n,a]=e,r=C):[r,t,n,a]=e,!r)return Z;Array.isArray(t)||(t=[t]),Array.isArray(n)||(n=[n]);const i=[],u=()=>{i.forEach(f=>f()),i.length=0},m=(f,l,w,p)=>(f.addEventListener(l,w,p),()=>f.removeEventListener(l,w,p)),S=x(()=>[se(r),N(a)],([f,l])=>{if(u(),!f)return;const w=Y(l)?{...l}:l;i.push(...t.flatMap(p=>n.map(v=>m(f,p,v,w))))},{immediate:!0,flush:"post"}),d=()=>{S(),u()};return Q(d),d}const A=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},E="__vueuse_ssr_handlers__",ie=ue();function ue(){return E in A||(A[E]=A[E]||{}),A[E]}function le(e,r){return ie[e]||r}function ce(e){return e==null?"any":e instanceof Set?"set":e instanceof Map?"map":e instanceof Date?"date":typeof e=="boolean"?"boolean":typeof e=="string"?"string":typeof e=="object"?"object":Number.isNaN(e)?"any":"number"}const fe={boolean:{read:e=>e==="true",write:e=>String(e)},object:{read:e=>JSON.parse(e),write:e=>JSON.stringify(e)},number:{read:e=>Number.parseFloat(e),write:e=>String(e)},any:{read:e=>e,write:e=>String(e)},string:{read:e=>e,write:e=>String(e)},map:{read:e=>new Map(JSON.parse(e)),write:e=>JSON.stringify(Array.from(e.entries()))},set:{read:e=>new Set(JSON.parse(e)),write:e=>JSON.stringify(Array.from(e))},date:{read:e=>new Date(e),write:e=>e.toISOString()}},W="vueuse-storage";function pe(e,r,t,n={}){var a;const{flush:i="pre",deep:u=!0,listenToStorageChanges:m=!0,writeDefaults:S=!0,mergeDefaults:d=!1,shallow:f,window:l=C,eventFilter:w,onError:p=o=>{console.error(o)},initOnMounted:v}=n,g=(f?q:O)(r);if(!t)try{t=le("getDefaultStorage",()=>{var o;return(o=C)==null?void 0:o.localStorage})()}catch(o){p(o)}if(!t)return g;const y=N(r),F=ce(y),h=(a=n.serializer)!=null?a:fe[F],{pause:z,resume:_}=oe(g,()=>J(g.value),{flush:i,deep:u,eventFilter:w});l&&m&&ae(()=>{t instanceof Storage?T(l,"storage",b):T(l,W,V),v&&b()}),v||b();function k(o,s){if(l){const c={key:e,oldValue:o,newValue:s,storageArea:t};l.dispatchEvent(t instanceof Storage?new StorageEvent("storage",c):new CustomEvent(W,{detail:c}))}}function J(o){try{const s=t.getItem(e);if(o==null)k(s,null),t.removeItem(e);else{const c=h.write(o);s!==c&&(t.setItem(e,c),k(s,c))}}catch(s){p(s)}}function M(o){const s=o?o.newValue:t.getItem(e);if(s==null)return S&&y!=null&&t.setItem(e,h.write(y)),y;if(!o&&d){const c=h.read(s);return typeof d=="function"?d(c,y):F==="object"&&!Array.isArray(c)?{...y,...c}:c}else return typeof s!="string"?s:h.read(s)}function b(o){if(!(o&&o.storageArea!==t)){if(o&&o.key==null){g.value=y;return}if(!(o&&o.key!==e)){z();try{(o==null?void 0:o.newValue)!==h.write(g.value)&&(g.value=M(o))}catch(s){p(s)}finally{o?j(_):_()}}}}function V(o){b(o.detail)}return g}function de(e,r,t={}){const{window:n=C}=t;return pe(e,r,n==null?void 0:n.localStorage,t)}const{Axios:Se,AxiosError:he,CanceledError:ve,isCancel:be,CancelToken:Ae,VERSION:Ee,all:Oe,Cancel:Ce,isAxiosError:ge,spread:Ne,toFormData:Fe,AxiosHeaders:_e,HttpStatusCode:ke,formToJSON:Te,getAdapter:We,mergeConfig:je}=K,ye=async(e,r)=>{var t;try{const{data:n}=await $.post("/auth/login/",{username:e,password:r});return{ok:!0,user:n.user,token:n.token}}catch(n){if(ge(n)&&((t=n.response)==null?void 0:t.status)===401)return{ok:!1,message:"usuario o contraseÃ±a incorrecta"};throw console.log(n),new Error("No se pudo realizar la peticion")}},xe=B("auth",()=>{const e=O(),r=O(de("token","")),t=async(a,i)=>{try{const u=await ye(a,i);return u.ok?(console.log(u),e.value=u.user,r.value=u.token,!0):(n(),!1)}catch(u){return console.log(u),n()}},n=()=>(localStorage.removeItem("token"),e.value=void 0,r.value="",!1);return{user:e,token:r,login:t,logout:n}});export{xe as u};
