import{d as Q,D as R,x as E,u as z,c as m,a,n as s,I as W,F as X,g as Y,v as r,t as d,o as p}from"./index-CozHna6C.js";import{u as I}from"./useQuery-w5Ei2Yfx.js";import{s as Z,u as _,a as ee,c as te,b as u,e as y}from"./vee-validate-Cs0uyyLT.js";import{e as c}from"./index-HRYNUPNB.js";import{g as ae}from"./get-employees.actions-BDlQVtjG.js";import{_ as ie}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./_commonjsHelpers-BosuxZz1.js";const ne=async t=>{if(t==="create")return{evaluatorId:"AddEvaluator",evaluationId:"AddEvaluation",employeeId:"",punctuality:0,attitude:0,quality:0,efficiency:0,initiative:0,hygiene:0};try{const{data:e}=await c.post("/evaluation/get/",{id:t});return{...e}}catch(e){throw console.log(e),new Error(`Error getting employee by id ${t}`)}},oe=async t=>{const e=t.id;return console.log(t),t.id&&t.id!==""?await se(e,t):await le(t)},se=async(t,e)=>{delete e.id;try{const{data:n}=await c.post("/evaluation/update/",{id:t,evaluation:e});return n}catch(n){throw console.log(n),new Error("uploading evaluation")}},le=async t=>{try{const{data:e}=await c.post("/evaluation/create/",t);return e}catch(e){throw console.log(e),new Error("Error creating evaluation")}},re=te({employeeId:u(),punctuality:u(),attitude:u(),quality:u(),efficiency:y(),initiative:y(),hygiene:y(),evaluationId:u()}),ue=Q({components:{InputText:Z},props:{evaluationId:{type:String,required:!0}},setup(t){const e=z(),{data:n,isError:f,isLoading:v}=I({queryKey:["evaluations",t.evaluationId],queryFn:()=>ne(t.evaluationId),retry:!1}),{isPending:g,isSuccess:i,data:S,mutate:q}=_({mutationFn:oe}),{values:A,defineField:o,errors:U,resetForm:b,handleSubmit:V,meta:F}=ee({validationSchema:re}),[$,h]=o("data.evaluation.employeeId.id"),[k,L]=o("data.evaluation.punctuality"),[B,C]=o("data.evaluation.attitude"),[N,x]=o("data.evaluation.quality"),[D,J]=o("data.evaluation.efficiency"),[M,O]=o("data.evaluation.initiative"),[P,H]=o("data.evaluation.hygiene"),[K,T]=o("evaluatorId"),j=V(async l=>{q(l.data.evaluation)}),{data:w}=I({queryKey:["employee"],queryFn:()=>ae()}),G=()=>w.value.data.map(l=>({label:l.person.fullname,value:l.id}));return R(()=>{if(f.value&&!v.value){e.replace("/empleado");return}}),E(n,()=>{n&&b({values:n.value})},{deep:!0,immediate:!0}),E(i,l=>{console.log("isUpdateSuccess"),l&&b({values:S.value})}),{values:A,errors:U,meta:F,isPending:g,employeeList:G(),employee:w,employeeId:$,employeeIdAttrs:h,punctuality:k,punctualityAttrs:L,attitude:B,attitudeAttrs:C,quality:N,qualityAttrs:x,efficiency:D,efficiencyAttrs:J,initiative:M,initiativeAttrs:O,hygiene:P,hygieneAttrs:H,evaluations:K,evaluationAttrs:T,onSubmit:j}}}),de={class:"flex items-center gap-4 mb-4"},me=["value"],pe={class:"flex items-center gap-4 mb-4"},ye={class:"flex items-center gap-4 mb-4"},ce={class:"flex items-center gap-4 mb-4"},fe={class:"flex items-center gap-4 mb-4"},ve={class:"flex items-center gap-4 mb-4"},ge={class:"flex items-center gap-4 mb-4"},be={class:"flex justify-end gap-2"},we=["disabled"],Ee={class:"grid grid-cols-2"},Ie={class:"bg-blue-200"},Se={class:"bg-red-200"},qe={class:"bg-green-200 col-span-2"};function Ae(t,e,n,f,v,g){return p(),m("div",null,[a("form",{onSubmit:e[7]||(e[7]=(...i)=>t.onSubmit&&t.onSubmit(...i))},[e[15]||(e[15]=a("span",{class:"text-surface-500 dark:text-surface-400 block mb-8"},"Agrega la informacion",-1)),a("div",de,[e[8]||(e[8]=a("label",{for:"Empleados",class:"font-semibold w-24"},"Empleados",-1)),s(a("select",{name:"employees",id:"employees",required:"","onUpdate:modelValue":e[0]||(e[0]=i=>t.employeeId=i)},[(p(!0),m(X,null,Y(t.employeeList,i=>(p(),m("option",{key:i.value,value:i.value},d(i.label),9,me))),128))],512),[[W,t.employeeId]])]),a("div",pe,[e[9]||(e[9]=a("label",{for:"puntual",class:"font-semibold w-24"},"Puntualidad",-1)),s(a("input",{type:"number",min:"0",max:"10",name:"punctuality",id:"punctuality","onUpdate:modelValue":e[1]||(e[1]=i=>t.punctuality=i)},null,512),[[r,t.punctuality]])]),a("div",ye,[e[10]||(e[10]=a("label",{for:"calidad",class:"font-semibold w-24"},"Calidad",-1)),s(a("input",{type:"number",min:"0",max:"10",name:"attitude",id:"attitude","onUpdate:modelValue":e[2]||(e[2]=i=>t.attitude=i)},null,512),[[r,t.attitude]])]),a("div",ce,[e[11]||(e[11]=a("label",{for:"calidad",class:"font-semibold w-24"},"Calidad",-1)),s(a("input",{type:"number",min:"0",max:"10",name:"puntual",id:"quality","onUpdate:modelValue":e[3]||(e[3]=i=>t.quality=i)},null,512),[[r,t.quality]])]),a("div",fe,[e[12]||(e[12]=a("label",{for:"Eficiencia",class:"font-semibold w-24"},"Eficiencia",-1)),s(a("input",{type:"number",min:"0",max:"10",name:"efficiency",id:"efficiency","onUpdate:modelValue":e[4]||(e[4]=i=>t.efficiency=i)},null,512),[[r,t.efficiency]])]),a("div",ve,[e[13]||(e[13]=a("label",{for:"Iniciativa",class:"font-semibold w-24"},"Iniciativa",-1)),s(a("input",{type:"number",min:"0",max:"10",name:"initiative",id:"initiative","onUpdate:modelValue":e[5]||(e[5]=i=>t.initiative=i)},null,512),[[r,t.initiative]])]),a("div",ge,[e[14]||(e[14]=a("label",{for:"Higiene",class:"font-semibold w-24"},"Higiene",-1)),s(a("input",{type:"number",min:"0",max:"10",name:"hygiene",id:"hygiene","onUpdate:modelValue":e[6]||(e[6]=i=>t.hygiene=i)},null,512),[[r,t.hygiene]])]),a("div",be,[a("button",{type:"submit",disabled:t.isPending,class:"disabled:bg-gray-200 bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded"}," Guardar ",8,we)])],32),a("div",Ee,[a("pre",Ie,"                "+d(JSON.stringify(t.values,null,2))+`
            `,1),a("pre",Se,"                "+d(JSON.stringify(t.errors,null,2))+`
            `,1),a("pre",qe,"                "+d(JSON.stringify(t.meta,null,2))+`
            `,1)])])}const Be=ie(ue,[["render",Ae]]);export{Be as default};
