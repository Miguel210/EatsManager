import{d as G,D as w,x as I,u as Q,c as u,a,n as c,I as A,F as Y,g as z,J as W,v as X,t as i,o as p}from"./index-CozHna6C.js";import{u as h}from"./useQuery-w5Ei2Yfx.js";import{s as Z,u as _,a as ee,c as te,b as E,e as $}from"./vee-validate-Cs0uyyLT.js";import{e as m}from"./index-HRYNUPNB.js";import{g as ae}from"./get-employees.actions-BDlQVtjG.js";import{_ as oe}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./_commonjsHelpers-BosuxZz1.js";const ne=async t=>{const e=t.id;return console.log(t),t.id&&t.id!==""?await se(e,t):await re(t)},se=async(t,e)=>{delete e.id;try{const{data:s}=await m.post("/attendance/update/",{id:t,attendance:e});return s}catch(s){throw console.log(s),new Error("uploading attendance")}},re=async t=>{try{const{data:e}=await m.post("/attendance/create/",t);return e}catch(e){throw console.log(e),new Error("Error creating attendance")}},de=async t=>{if(console.log(t),t==="create")return{data:{employeeId:"",date:"",hour:"",isActive:!0,documentId:""}};try{const{data:e}=await m.post("/attendance/get/",{id:t});return{...e}}catch(e){throw console.log(e),new Error(`Error getting attendance by id ${t}`)}},ie=te({employeeId:E(),documentId:E(),date:$(),hour:$()}),le=G({components:{InputText:Z},props:{empleadoId:{type:String,required:!0}},setup(t){const e=Q();let s;const{data:r,isError:f,isLoading:g}=h({queryKey:["attencanceById",t.empleadoId],queryFn:()=>de(t.empleadoId),retry:!1}),{isPending:n,isSuccess:F,data:q,mutate:D}=_({mutationFn:ne}),{values:k,defineField:d,errors:U,resetForm:b,handleSubmit:V,meta:B}=ee({validationSchema:ie}),[L,M]=d("data.employeeId"),[N,T]=d("data.documentId"),[l,J]=d("data.date"),[y,H]=d("data.hour"),O=V(async o=>{D(o)}),{data:v}=h({queryKey:["employee"],queryFn:()=>ae()}),x=()=>v.value.data.map(o=>({label:o.person.fullname,value:o.id}));return w(()=>{if(f.value&&!g.value){e.replace("/empleado");return}}),w(()=>{const o=new Date,C=o.getFullYear(),K=String(o.getMonth()+1).padStart(2,"0"),P=String(o.getDate()).padStart(2,"0"),R=String(o.getHours()).padStart(2,"0"),j=String(o.getMinutes()).padStart(2,"0");s=`${C}-${K}-${P}T${R}:${j}`;const S=-6;l.value=new Date(o.getTime()+S*60*60*1e3),y.value=new Date(o.getTime()+S*60*60*1e3),console.log(l.value)}),I(r,()=>{r&&b({values:r.value})},{deep:!0,immediate:!0}),I(F,o=>{console.log("isUpdateSuccess"),o&&b({values:q.value})}),{values:k,errors:U,meta:B,isPending:n,timeAttendace:s,employeeList:x(),employee:v,employeeId:L,employeeIdAttrs:M,documentId:N,documentIdAttrs:T,date:l,dateAttrs:J,hour:y,hourAttrs:H,onSubmit:O}}}),ue={class:"flex items-center gap-4 mb-4"},ce=["value"],pe={class:"flex items-center gap-4 mb-4"},me={class:"flex items-center gap-4 mb-4"},fe={class:"flex justify-end gap-2"},ge=["disabled"],be={class:"grid grid-cols-2"},ye={class:"bg-blue-200"},ve={class:"bg-red-200"},Se={class:"bg-green-200 col-span-2"};function we(t,e,s,r,f,g){return p(),u("div",null,[a("form",{onSubmit:e[3]||(e[3]=(...n)=>t.onSubmit&&t.onSubmit(...n))},[e[8]||(e[8]=a("span",{class:"text-surface-500 dark:text-surface-400 block mb-8"},"Agrega la informacion",-1)),a("div",ue,[e[4]||(e[4]=a("label",{for:"Empleados",class:"font-semibold w-24"},"Empleados",-1)),c(a("select",{name:"employees",id:"employees",required:"","onUpdate:modelValue":e[0]||(e[0]=n=>t.employeeId=n)},[(p(!0),u(Y,null,z(t.employeeList,n=>(p(),u("option",{key:n.value,value:n.value},i(n.label),9,ce))),128))],512),[[A,t.employeeId]])]),a("div",pe,[e[6]||(e[6]=a("label",{for:"Empleados",class:"font-semibold w-24"},"Estatus",-1)),c(a("select",{name:"employees",id:"employees",required:"","onUpdate:modelValue":e[1]||(e[1]=n=>t.documentId=n)},e[5]||(e[5]=[W('<option value="7f27a133-2391-4896-946f-07d0545256e6">Entrada</option><option value="5605ff8d-b6b2-4822-9937-254de77b3045">Salida</option><option value="7d86a30a-4986-4aeb-9acc-b389c760cc3b">Falta</option><option value="c95c3801-ab84-44a0-842f-3aab888aaf3f">Retardo</option><option value="9f32dea6-8a1d-4093-a873-73365a9b5b91">Horas extra</option><option value="b8bf6180-ea9d-4233-8a6e-0fa59b9b0275">Salida antes (permiso)</option><option value="de7ca9a4-8387-4cd0-b2e6-b57c002a9cdc">Entrada tardoa (permiso)</option>',7)]),512),[[A,t.documentId]])]),a("div",me,[e[7]||(e[7]=a("label",{for:"puntual",class:"font-semibold w-24"},"Hora y fecha",-1)),c(a("input",{type:"datetime-local",name:"timeAttendace",id:"timeAttendace",disabled:"","onUpdate:modelValue":e[2]||(e[2]=n=>t.timeAttendace=n)},null,512),[[X,t.timeAttendace]])]),a("div",fe,[a("button",{type:"submit",disabled:t.isPending,class:"disabled:bg-gray-200 bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded"}," Guardar ",8,ge)])],32),a("div",be,[a("pre",ye,"                "+i(JSON.stringify(t.values,null,2))+`
            `,1),a("pre",ve,"                "+i(JSON.stringify(t.errors,null,2))+`
            `,1),a("pre",Se,"                "+i(JSON.stringify(t.meta,null,2))+`
            `,1)])])}const De=oe(le,[["render",we]]);export{De as default};
